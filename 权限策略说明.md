# 权限策略警告说明

## ⚠️ 警告信息

你看到的这些警告：

```
[Violation] Potential permissions policy violation: autoplay is not allowed
[Violation] Potential permissions policy violation: encrypted-media is not allowed
[Violation] Potential permissions policy violation: fullscreen is not allowed
[Violation] Potential permissions policy violation: picture-in-picture is not allowed
```

## 🔍 原因

这是浏览器的**权限策略（Permissions Policy）**机制，用于控制 iframe 中可以使用的功能。

当你在 `<iframe>` 标签中使用 `allow="autoplay; encrypted-media"` 时，浏览器会检查：
1. 父页面是否允许这些权限
2. 被嵌入的页面是否允许这些权限

如果权限策略没有正确声明，浏览器会发出警告。

## ✅ 已修复

我已经在所有相关 HTML 文件的 `<head>` 中添加了权限策略声明：

```html
<meta http-equiv="Permissions-Policy" content="autoplay=(self), encrypted-media=(self), fullscreen=(self), picture-in-picture=(self)" />
```

这个策略允许：
- ✅ `autoplay` - 自动播放视频
- ✅ `encrypted-media` - 加密媒体（DRM）
- ✅ `fullscreen` - 全屏功能
- ✅ `picture-in-picture` - 画中画功能

所有这些权限都限制在**同源**（`self`），即只能在自己的域名下使用。

## 📋 修改的文件

1. ✅ `index.html` - 外层框架
2. ✅ `iframe.html` - 广告容器
3. ✅ `feed-v2.html` - 广告内容

## 🎯 效果

添加后，这些警告应该会消失或减少。

**注意**：
- 这些是**警告**，不是错误，不会阻止功能运行
- 如果警告仍然存在，可能是浏览器缓存的问题，尝试清除缓存或硬刷新（Cmd+Shift+R）

## 🔧 如果警告仍然存在

### 方法 1：清除浏览器缓存
- Chrome/Edge: `Cmd+Shift+Delete` → 清除缓存
- 或者硬刷新：`Cmd+Shift+R`

### 方法 2：检查控制台
打开浏览器控制台，查看警告是否减少。

### 方法 3：使用本地服务器
这些警告在使用 `file://` 协议时更常见。使用本地服务器可以减少警告：
```bash
python3 -m http.server 8000
```

## 📚 更多信息

关于浏览器权限策略的详细说明：
- [MDN Permissions Policy](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Permissions-Policy)
- [Chrome Permissions Policy](https://developer.chrome.com/docs/privacy-sandbox/permissions-policy/)



